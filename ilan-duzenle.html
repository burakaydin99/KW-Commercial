<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ä°lan DÃ¼zenle - KW Commercial</title>
    <script src="js/shared-data.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/ilan-duzenle.css">
    <script src="js/firebase-config.js" type="module"></script>
    <script src="js/auth-service.js" type="module"></script>
    <script src="js/firestore-service.js" type="module"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <h1><a href="index.html">KW Commercial</a></h1>
            </div>
            <div class="auth-section">
                <button id="loginBtn" class="login-btn">Google ile GiriÅŸ Yap</button>
                <div id="userInfo" class="user-info" style="display: none;">
                    <span id="userName">KullanÄ±cÄ±</span>
                    <button id="logoutBtn" class="logout-btn">Ã‡Ä±kÄ±ÅŸ</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Loading -->
    <div class="loading" id="loadingSpinner">
        <div class="spinner"></div>
        <p>Ä°lan yÃ¼kleniyor...</p>
    </div>

    <!-- Error Message -->
    <div class="error-message" id="errorMessage" style="display: none;">
        <div class="error-container">
            <h2>Ä°lan BulunamadÄ±</h2>
            <p>DÃ¼zenlemek istediÄŸiniz ilan mevcut deÄŸil veya dÃ¼zenleme yetkiniz bulunmuyor.</p>
            <button class="back-btn" onclick="goBack()">â† Ana Sayfaya DÃ¶n</button>
        </div>
    </div>

    <!-- Edit Form Container -->
    <div class="form-container" id="editContainer" style="display: none;">
        <div class="form-header">
            <div>
                <h2>Ä°lan DÃ¼zenle</h2>
                <p>Ticari gayrimenkul ilanÄ±nÄ±zÄ±n detaylarÄ±nÄ± gÃ¼ncelleyiniz</p>
            </div>
            <button class="back-btn" onclick="goBack()">â† Geri DÃ¶n</button>
        </div>

        <form id="editListingForm" class="listing-form">
            <div class="form-section">
                <h3>Temel Bilgiler</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="listingTitle">Ä°lan BaÅŸlÄ±ÄŸÄ± *</label>
                        <input type="text" id="listingTitle" name="listingTitle" required 
                               placeholder="Ã–rn: Merkezi Konumda SatÄ±lÄ±k Ofis">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="listingDate">Tarih *</label>
                        <input type="date" id="listingDate" name="listingDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="advisorDetails">DanÄ±ÅŸman Detay *</label>
                        <input type="text" id="advisorDetails" name="advisorDetails" required 
                               placeholder="DanÄ±ÅŸman adÄ± ve iletiÅŸim bilgileri">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="portfolioType">PortfÃ¶y Cinsi *</label>
                        <select id="portfolioType" name="portfolioType" required>
                            <option value="">SeÃ§iniz</option>
                            <option value="MUSTAKÄ°L BÄ°NA">Mustakil Bina</option>
                            <option value="BÄ°NA KATI VEYA BÃ–LÃœMÃœ">Bina KatÄ± veya BÃ¶lÃ¼mÃ¼</option>
                            <option value="DÃœKKAN-MAÄAZA">DÃ¼kkan-MaÄŸaza</option>
                            <option value="ARSA">Arsa</option>
                            <option value="TARLA">Tarla</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="usagePurpose">KullanÄ±m AmacÄ± *</label>
                        <select id="usagePurpose" name="usagePurpose" required>
                            <option value="">SeÃ§iniz</option>
                            <option value="HÄ°ZMET OFÄ°S">Hizmet Ofis</option>
                            <option value="EÄÄ°TÄ°M">EÄŸitim</option>
                            <option value="SAÄLIK">SaÄŸlÄ±k</option>
                            <option value="TURÄ°ZM">Turizm</option>
                            <option value="PERAKENDE">Perakende</option>
                            <option value="GIDA">GÄ±da</option>
                            <option value="SANAYÄ°-Ä°MALAT">Sanayi-Ä°malat</option>
                            <option value="LOJÄ°STÄ°K">Lojistik</option>
                            <option value="YURT">Yurt</option>
                            <option value="YATIRIM">YatÄ±rÄ±m</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3>Konum Bilgileri</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="city">Ä°l *</label>
                        <select id="city" name="city" required>
                            <option value="">SeÃ§iniz</option>
                            <option value="Ä°stanbul">Ä°stanbul</option>
                            <option value="Ankara">Ankara</option>
                            <option value="Ä°zmir">Ä°zmir</option>
                            <option value="Bursa">Bursa</option>
                            <option value="Antalya">Antalya</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="district">Ä°lÃ§e *</label>
                        <select id="district" name="district" required>
                            <option value="">Ã–nce il seÃ§iniz</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="neighborhood">Mahalle *</label>
                        <select id="neighborhood" name="neighborhood" required>
                            <option value="">Ã–nce ilÃ§e seÃ§iniz</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="islandParcel">Ada / Parsel</label>
                        <input type="text" id="islandParcel" name="islandParcel" 
                               placeholder="Ã–rn: Ada: 123, Parsel: 45">
                    </div>

                    <div class="form-group">
                        <label for="zoningStatus">Ä°mar Durumu</label>
                        <input type="text" id="zoningStatus" name="zoningStatus" 
                               placeholder="Ã–rn: Ticari, Konut, Sanayi">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3>Fiyat ve GÃ¶rsel</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="price">Fiyat (TL) *</label>
                        <input type="number" id="price" name="price" required 
                               placeholder="0" min="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="listingImage">Ä°lan GÃ¶rseli</label>
                        <input type="file" id="listingImage" name="listingImage" 
                               accept="image/*" class="file-input">
                        <div class="file-preview" id="imagePreview" style="display: none;">
                            <img id="previewImg" src="" alt="Ã–nizleme">
                            <button type="button" class="remove-image" onclick="removeImage()">Ã—</button>
                        </div>
                        <div class="current-image" id="currentImage" style="display: none;">
                            <p>Mevcut GÃ¶rsel:</p>
                            <img id="currentImg" src="" alt="Mevcut GÃ¶rsel">
                        </div>
                    </div>
                </div>
            </div>

            <!-- AÃ§Ä±klama BÃ¶lÃ¼mÃ¼ -->
            <div class="form-section">
                <h3>AÃ§Ä±klama</h3>
                
                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="description">DetaylÄ± AÃ§Ä±klama</label>
                        <textarea id="description" name="description" rows="5" 
                                  placeholder="GayrimenkulÃ¼n detaylÄ± aÃ§Ä±klamasÄ±nÄ± yazÄ±nÄ±z..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                <button type="button" class="delete-btn" id="deleteBtn">
                    ğŸ—‘ï¸ Ä°lanÄ± Sil
                </button>
                <button type="button" class="cancel-btn" onclick="goBack()">
                    Ä°ptal
                </button>
                <button type="submit" class="submit-btn">
                    ğŸ’¾ DeÄŸiÅŸiklikleri Kaydet
                </button>
            </div>
        </form>
    </div>

    <!-- Saving Indicator -->
    <div class="saving-indicator" id="savingIndicator" style="display: none;">
        Kaydediliyor...
    </div>



<script type="module">
    import { authService } from './js/auth-service.js';
    import { firestoreService } from './js/firestore-service.js';
    
    // Global olarak eriÅŸilebilir yap
    window.authService = authService;
    window.firestoreService = firestoreService;
    
    console.log('âœ… Firebase servisleri global olarak yÃ¼klendi');
</script>

    <!-- Script dosyasÄ±nÄ± en sona taÅŸÄ±yÄ±n -->
    <script src="js/ilan-duzenle.js"></script>
</body>
</html>